<!-- Live Rates Ticker Bar -->
<app-gold-ticker />

<!-- Main Header -->
<header class="header" [class.scrolled]="isScrolled()">
  <div class="header-inner container">
    <!-- Mobile Menu Toggle -->
    <button
      class="mobile-menu-toggle"
      (click)="toggleMobileMenu()"
      [attr.aria-expanded]="isMobileMenuOpen()"
      aria-label="Toggle navigation menu">
      <span class="hamburger" [class.active]="isMobileMenuOpen()">
        <span></span>
        <span></span>
        <span></span>
      </span>
    </button>

    <!-- Logo -->
    <a routerLink="/" class="logo" (click)="closeMobileMenu()">
      <img src="SRJ Logo.png" alt="Sree Radheya Jewellers" class="logo-img">
      <div class="logo-text">
        <span class="logo-brand">Sree Radheya</span>
        <span class="logo-sub">J E W E L L E R S</span>
      </div>
    </a>

    <!-- Desktop Navigation -->
    <nav class="desktop-nav" role="navigation" aria-label="Main navigation">
      <ul class="nav-list">
        <li class="nav-item">
          <a routerLink="/" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}">Home</a>
        </li>
        <li class="nav-item has-dropdown"
            (mouseenter)="setDropdown('collections')"
            (mouseleave)="setDropdown(null)">
          <a routerLink="/collections" routerLinkActive="active">Collections</a>
          <!-- Mega Menu -->
          <div class="mega-menu" [class.open]="activeDropdown() === 'collections'">
            <div class="mega-menu-inner">
              <div class="mega-col">
                <h4 class="mega-heading">Shop by Category</h4>
                <ul class="mega-list">
                  @for (cat of categories; track cat.slug) {
                    <li>
                      <a [routerLink]="['/collections']" [queryParams]="{category: cat.slug}"
                         (click)="setDropdown(null)">
                        <span class="mega-icon">{{ cat.icon }}</span>
                        {{ cat.name }}
                      </a>
                    </li>
                  }
                </ul>
              </div>
              <div class="mega-col">
                <h4 class="mega-heading">Our Collections</h4>
                <ul class="mega-list">
                  @for (col of collections; track col.slug) {
                    <li>
                      <a [routerLink]="['/collections']" [queryParams]="{collection: col.slug}"
                         (click)="setDropdown(null)">
                        {{ col.name }}
                      </a>
                    </li>
                  }
                </ul>
              </div>
              <div class="mega-col mega-featured">
                <div class="mega-featured-card">
                  <img src="https://images.unsplash.com/photo-1599643478518-a784e5dc4c8f?w=300&h=200&fit=crop"
                       alt="New Arrivals" loading="lazy">
                  <div class="mega-featured-content">
                    <span class="mega-featured-label">New Arrivals</span>
                    <p>Discover our latest handcrafted masterpieces</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </li>
        <li class="nav-item">
          <a routerLink="/about" routerLinkActive="active">Our Story</a>
        </li>
        <li class="nav-item">
          <a routerLink="/custom-jewellery" routerLinkActive="active">Custom Design</a>
        </li>
        <li class="nav-item">
          <a routerLink="/contact" routerLinkActive="active">Contact</a>
        </li>
      </ul>
    </nav>

    <!-- Header Actions -->
    <div class="header-actions">
      <button class="action-btn" (click)="toggleSearch()" aria-label="Search">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
          <circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/>
        </svg>
      </button>
      <a routerLink="/wishlist" class="action-btn" aria-label="Wishlist">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
          <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/>
        </svg>
        @if (wishlist.items().length > 0) {
          <span class="action-badge">{{ wishlist.items().length }}</span>
        }
      </a>
      <button class="action-btn" (click)="cart.toggleCart()" aria-label="Inquiry list">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
          <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/>
        </svg>
        @if (cart.itemCount() > 0) {
          <span class="action-badge">{{ cart.itemCount() }}</span>
        }
      </button>
    </div>
  </div>

  <!-- Search Overlay -->
  @if (isSearchOpen()) {
    <div class="search-overlay" (click)="toggleSearch()">
      <div class="search-container" (click)="$event.stopPropagation()">
        <input
          type="text"
          class="search-input"
          placeholder="Search for jewellery, collections, gemstones..."
          autofocus>
        <button class="search-close" (click)="toggleSearch()" aria-label="Close search">âœ•</button>
      </div>
    </div>
  }
</header>

<!-- Mobile Menu -->
<div class="mobile-menu" [class.open]="isMobileMenuOpen()">
  <div class="mobile-menu-inner">
    <nav class="mobile-nav">
      <a routerLink="/" (click)="closeMobileMenu()" class="mobile-nav-link">Home</a>
      <a routerLink="/collections" (click)="closeMobileMenu()" class="mobile-nav-link">Collections</a>

      <div class="mobile-nav-group">
        <span class="mobile-nav-label">Shop by Category</span>
        @for (cat of categories; track cat.slug) {
          <a [routerLink]="['/collections']"
             [queryParams]="{category: cat.slug}"
             (click)="closeMobileMenu()"
             class="mobile-nav-sublink">
            {{ cat.name }}
          </a>
        }
      </div>

      <a routerLink="/about" (click)="closeMobileMenu()" class="mobile-nav-link">Our Story</a>
      <a routerLink="/custom-jewellery" (click)="closeMobileMenu()" class="mobile-nav-link">Custom Design</a>
      <a routerLink="/contact" (click)="closeMobileMenu()" class="mobile-nav-link">Contact</a>
    </nav>

    <div class="mobile-menu-footer">
      <a href="tel:+918019870128" class="mobile-contact">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72c.127.96.361 1.903.7 2.81a2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45c.907.339 1.85.573 2.81.7A2 2 0 0 1 22 16.92z"/></svg>
        +91 80198 70128
      </a>
      <div class="mobile-social">
        <a href="#" aria-label="Instagram">Instagram</a>
        <a href="#" aria-label="Facebook">Facebook</a>
        <a href="#" aria-label="Pinterest">Pinterest</a>
      </div>
    </div>
  </div>
</div>

<!-- Mobile Menu Overlay -->
@if (isMobileMenuOpen()) {
  <div class="mobile-overlay" (click)="closeMobileMenu()"></div>
}
